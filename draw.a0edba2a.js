var w=Object.defineProperty;var f=(p,n,t)=>n in p?w(p,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):p[n]=t;var r=(p,n,t)=>(f(p,typeof n!="symbol"?n+"":n,t),t);class P{constructor(n){r(this,"tempShapePoints");r(this,"viewer");r(this,"Cesium");r(this,"type");r(this,"drawStatus");r(this,"entityList");const{type:t,color:i,viewer:h,Cesium:a}=n;this.tempShapePoints=[],this.entityList=[],this.viewer=h,this.Cesium=a,this.drawStatus="stop",this.type=t,this._init(n)}_init(n){this.drawStatus="start",document.body.style.cursor="crosshair";const{viewer:t,Cesium:i}=n;t.scene.pickPositionSupported||window.alert("This browser does not support pickPosition."),t.cesiumWidget.screenSpaceEventHandler.removeInputAction(i.ScreenSpaceEventType.LEFT_DOUBLE_CLICK);function h(s,e){const u=t.entities.add({position:s,point:{color:i.Color.WHITE,pixelSize:5,heightReference:i.HeightReference.CLAMP_TO_GROUND}});return e.entityList.push(u),u}let a=this.type;function S(s){let e;return a==="line"?e=t.entities.add({polyline:{positions:s,clampToGround:!0,width:3}}):a==="polygon"&&(e=t.entities.add({polygon:{hierarchy:s,material:new i.ColorMaterialProperty(i.Color.WHITE.withAlpha(.5))}})),e}let o=[],d,c;function y(s){document.body.style.cursor="auto",o.pop(),s.entityList.push(S(o)),t.entities.remove(c),t.entities.remove(d),c=void 0,d=void 0,o=[],s.drawStatus="stop"}const l=new i.ScreenSpaceEventHandler(t.canvas);l.setInputAction(s=>{if(this.drawStatus==="stop")return;const e=t.scene.pickPosition(s.position);if(i.defined(e)){if(o.length===0){c=h(e,this),o.push(e);const u=new i.CallbackProperty(function(){return a==="polygon"?new i.PolygonHierarchy(o):o},!1);d=S(u)}o.push(e),h(e,this)}},i.ScreenSpaceEventType.LEFT_CLICK),l.setInputAction(s=>{if(this.drawStatus!=="stop"&&i.defined(c)){const e=t.scene.pickPosition(s.endPosition);i.defined(e)&&(c.position.setValue(e),o.pop(),o.push(e))}},i.ScreenSpaceEventType.MOUSE_MOVE),l.setInputAction(s=>{if(this.drawStatus==="stop")return;let e=JSON.parse(JSON.stringify(o));e.pop(),this.tempShapePoints=e,y(this)},i.ScreenSpaceEventType.RIGHT_CLICK)}stopDraw(){this.drawStatus="stop",this.entityList.forEach(n=>{this.viewer.entities.remove(n)})}}export{P as D};
